{% comment %}ly_global_begin{% endcomment %}{% capture ly-global-content %}{% render 'ly-global' render:true %}{% endcapture %}{% assign ly-global-content = ly-global-content | split: '#ly#' %}{% assign langify_title = ly-global-content[0] %}{% assign langify_description = ly-global-content[1] %}{% assign langify_shop_name = ly-global-content[2] %}{% assign langify_shop_description = ly-global-content[3] %}{% assign canonical_langify_url = ly-global-content[4] %}{% assign langify_shop_url = ly-global-content[5] %}{% assign langify_shop_domain = ly-global-content[6] %}{% comment %}ly_global_end{% endcomment %}{% if shop.metafields.geolizr.notification_widget_enabled == 'true' %}
<script>
    Geolizr.addSystemEventListener('geolizr.init.notification', function(e) {
        var $ = e.jquery;
        Geolizr.getGeoData(function(geoData) {
            {% if shop.metafields.geolizr.notifications_json %}
                Geolizr.notifications = {% comment %}ly_code_replace_for_[ shop.metafields.geolizr.notifications_json | json ]_begin{% endcomment %}{% if request.host %}{% assign host = request.host %}{% assign domains = shop.metafields.language_domains %}{% for domain in domains %}{% assign key = domain | first %}{% assign value = domain | last | split: ',' %}{% if value contains host %}{% assign language = key %}{% endif %}{% endfor %}{% if language == nil %}{% assign language = shop.metafields["languages"]["default"] %}{% endif %}{% else %}{% assign language = cart.attributes["language"] %}{% if language == nil %}{% assign language = shop.metafields["languages"]["default"] %}{% endif %}{% endif %}{% assign ns = language | append: 'geolizr' %}{% assign key = 'notifications_json' %}{% if shop.metafields[ns][key] %}{% assign ly_translation = shop.metafields[ns][key] %}{% else %}{% assign ly_translation =  shop.metafields.geolizr.notifications_json | json  %}{% endif %}{{ ly_translation | json }}{% comment %}ly_code_replace_end{% endcomment %};
            {% else %}
                Geolizr.notifications = {% comment %}ly_code_replace_for_[ shop.metafields.geolizr.notifications ]_begin{% endcomment %}{% if request.host %}{% assign host = request.host %}{% assign domains = shop.metafields.language_domains %}{% for domain in domains %}{% assign key = domain | first %}{% assign value = domain | last | split: ',' %}{% if value contains host %}{% assign language = key %}{% endif %}{% endfor %}{% if language == nil %}{% assign language = shop.metafields["languages"]["default"] %}{% endif %}{% else %}{% assign language = cart.attributes["language"] %}{% if language == nil %}{% assign language = shop.metafields["languages"]["default"] %}{% endif %}{% endif %}{% assign ns = language | append: 'geolizr' %}{% assign key = 'notifications' %}{% if shop.metafields[ns][key] %}{% assign ly_translation = shop.metafields[ns][key] %}{% else %}{% assign ly_translation =  shop.metafields.geolizr.notifications  %}{% endif %}{{ ly_translation }}{% comment %}ly_code_replace_end{% endcomment %};
            {% endif %}
            {% if shop.metafields.geolizr.country_to_notification_json %}
                Geolizr.regionToNotification = {% comment %}ly_code_replace_for_[ shop.metafields.geolizr.country_to_notification_json  | json ]_begin{% endcomment %}{% if request.host %}{% assign host = request.host %}{% assign domains = shop.metafields.language_domains %}{% for domain in domains %}{% assign key = domain | first %}{% assign value = domain | last | split: ',' %}{% if value contains host %}{% assign language = key %}{% endif %}{% endfor %}{% if language == nil %}{% assign language = shop.metafields["languages"]["default"] %}{% endif %}{% else %}{% assign language = cart.attributes["language"] %}{% if language == nil %}{% assign language = shop.metafields["languages"]["default"] %}{% endif %}{% endif %}{% assign ns = language | append: 'geolizr' %}{% assign key = 'country_to_notification_json' %}{% if shop.metafields[ns][key] %}{% assign ly_translation = shop.metafields[ns][key] %}{% else %}{% assign ly_translation =  shop.metafields.geolizr.country_to_notification_json  | json  %}{% endif %}{{ ly_translation  | json }}{% comment %}ly_code_replace_end{% endcomment %};
            {% else %}
                Geolizr.regionToNotification = {% comment %}ly_code_replace_for_[ shop.metafields.geolizr.country_to_notification ]_begin{% endcomment %}{% if request.host %}{% assign host = request.host %}{% assign domains = shop.metafields.language_domains %}{% for domain in domains %}{% assign key = domain | first %}{% assign value = domain | last | split: ',' %}{% if value contains host %}{% assign language = key %}{% endif %}{% endfor %}{% if language == nil %}{% assign language = shop.metafields["languages"]["default"] %}{% endif %}{% else %}{% assign language = cart.attributes["language"] %}{% if language == nil %}{% assign language = shop.metafields["languages"]["default"] %}{% endif %}{% endif %}{% assign ns = language | append: 'geolizr' %}{% assign key = 'country_to_notification' %}{% if shop.metafields[ns][key] %}{% assign ly_translation = shop.metafields[ns][key] %}{% else %}{% assign ly_translation =  shop.metafields.geolizr.country_to_notification  %}{% endif %}{{ ly_translation }}{% comment %}ly_code_replace_end{% endcomment %};
            {% endif %}
            var notification = Geolizr.getNotification();
            Geolizr.notificationShadowUrl = '{% comment %}ly_asset_replace_for_[ 'geolizr-notification-shadow.png' | asset_url ]_begin{% endcomment %}{% assign ly_asset = 'geolizr-notification-shadow.png' %}{% capture ly_translation %}{% render 'ly-asset' with ly_asset render:true %}{% endcapture %}{{ ly_translation  }}{% comment %}ly_asset_replace_end{% endcomment %}';
            Geolizr.notification(notification, geoData, Geolizr.notificationShadowUrl);
        });
    });
</script>
{% endif %}