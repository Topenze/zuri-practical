{% comment %}ly_global_begin{% endcomment %}{% capture ly-global-content %}{% render 'ly-global' render:true %}{% endcapture %}{% assign ly-global-content = ly-global-content | split: '#ly#' %}{% assign langify_title = ly-global-content[0] %}{% assign langify_description = ly-global-content[1] %}{% assign langify_shop_name = ly-global-content[2] %}{% assign langify_shop_description = ly-global-content[3] %}{% assign canonical_langify_url = ly-global-content[4] %}{% assign langify_shop_url = ly-global-content[5] %}{% assign langify_shop_domain = ly-global-content[6] %}{% comment %}ly_global_end{% endcomment %}
{% if shop.metafields.pagefly.acceptTracking %}
<script>window.__pagefly_analytics_settings__={
	acceptNewTracking: true, 
	enableTrackingRevenue: {% comment %}ly_code_replace_for_[shop.metafields.pagefly.enableTrackingRevenue | default: false]_begin{% endcomment %}{% if request.host %}{% assign host = request.host %}{% assign domains = shop.metafields.language_domains %}{% for domain in domains %}{% assign key = domain | first %}{% assign value = domain | last | split: ',' %}{% if value contains host %}{% assign language = key %}{% endif %}{% endfor %}{% if language == nil %}{% assign language = shop.metafields["languages"]["default"] %}{% endif %}{% else %}{% assign language = cart.attributes["language"] %}{% if language == nil %}{% assign language = shop.metafields["languages"]["default"] %}{% endif %}{% endif %}{% assign ns = language | append: 'pagefly' %}{% assign key = 'enableTrackingRevenue' %}{% if shop.metafields[ns][key] %}{% assign ly_translation = shop.metafields[ns][key] %}{% else %}{% assign ly_translation = shop.metafields.pagefly.enableTrackingRevenue | default: false %}{% endif %}{{ly_translation | default: false}}{% comment %}ly_code_replace_end{% endcomment %}, 
	sessionTimeout: {% comment %}ly_code_replace_for_[ shop.metafields.pagefly.sessionTimeout | default: 30 ]_begin{% endcomment %}{% if request.host %}{% assign host = request.host %}{% assign domains = shop.metafields.language_domains %}{% for domain in domains %}{% assign key = domain | first %}{% assign value = domain | last | split: ',' %}{% if value contains host %}{% assign language = key %}{% endif %}{% endfor %}{% if language == nil %}{% assign language = shop.metafields["languages"]["default"] %}{% endif %}{% else %}{% assign language = cart.attributes["language"] %}{% if language == nil %}{% assign language = shop.metafields["languages"]["default"] %}{% endif %}{% endif %}{% assign ns = language | append: 'pagefly' %}{% assign key = 'sessionTimeout' %}{% if shop.metafields[ns][key] %}{% assign ly_translation = shop.metafields[ns][key] %}{% else %}{% assign ly_translation =  shop.metafields.pagefly.sessionTimeout | default: 30  %}{% endif %}{{ ly_translation | default: 30 }}{% comment %}ly_code_replace_end{% endcomment %},
	timezoneOffset: {% comment %}ly_code_replace_for_[ shop.metafields.pagefly.timezoneOffset | default: 0 ]_begin{% endcomment %}{% if request.host %}{% assign host = request.host %}{% assign domains = shop.metafields.language_domains %}{% for domain in domains %}{% assign key = domain | first %}{% assign value = domain | last | split: ',' %}{% if value contains host %}{% assign language = key %}{% endif %}{% endfor %}{% if language == nil %}{% assign language = shop.metafields["languages"]["default"] %}{% endif %}{% else %}{% assign language = cart.attributes["language"] %}{% if language == nil %}{% assign language = shop.metafields["languages"]["default"] %}{% endif %}{% endif %}{% assign ns = language | append: 'pagefly' %}{% assign key = 'timezoneOffset' %}{% if shop.metafields[ns][key] %}{% assign ly_translation = shop.metafields[ns][key] %}{% else %}{% assign ly_translation =  shop.metafields.pagefly.timezoneOffset | default: 0  %}{% endif %}{{ ly_translation | default: 0 }}{% comment %}ly_code_replace_end{% endcomment %}
};
  // load pagefly analytics new verion
  const analyticsSrc = "https://cdn.pagefly.io/pagefly/core/analytics.js"
  const scriptPFAnalytic = document.createElement('script')
  scriptPFAnalytic.src = analyticsSrc
  scriptPFAnalytic.async = true
  scriptPFAnalytic.defer = false
  scriptPFAnalytic.onload = () => {
    console.log("load analytics new version sucessfully")
  }
  scriptPFAnalytic.onerror = () => {
    console.log("load analytics new version unsuccessfully")
  }
  document.body.appendChild(scriptPFAnalytic)
</script>
{% endif %}

{% if shop.metafields.pagefly.globalSetting %}{% comment %}ly_code_replace_for_[ shop.metafields.pagefly.globalSetting ]_begin{% endcomment %}{% if request.host %}{% assign host = request.host %}{% assign domains = shop.metafields.language_domains %}{% for domain in domains %}{% assign key = domain | first %}{% assign value = domain | last | split: ',' %}{% if value contains host %}{% assign language = key %}{% endif %}{% endfor %}{% if language == nil %}{% assign language = shop.metafields["languages"]["default"] %}{% endif %}{% else %}{% assign language = cart.attributes["language"] %}{% if language == nil %}{% assign language = shop.metafields["languages"]["default"] %}{% endif %}{% endif %}{% assign ns = language | append: 'pagefly' %}{% assign key = 'globalSetting' %}{% if shop.metafields[ns][key] %}{% assign ly_translation = shop.metafields[ns][key] %}{% else %}{% assign ly_translation =  shop.metafields.pagefly.globalSetting  %}{% endif %}{{ ly_translation }}{% comment %}ly_code_replace_end{% endcomment %}{% endif %}
{% comment %}ly_asset_replace_for_[ 'pagefly-main.css' | asset_url | stylesheet_tag: preload: true ]_begin{% endcomment %}{% assign ly_asset = 'pagefly-main.css' %}{% capture ly_translation %}{% render 'ly-asset' with ly_asset render:true %}{% endcapture %}{{ ly_translation  | stylesheet_tag: preload: true }}{% comment %}ly_asset_replace_end{% endcomment %}
